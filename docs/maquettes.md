# TUI Maquettes â€” V2 Flash Toolkit

**Conventions**

* Footer shows hints: `â†‘/â†“ select Â· Enter confirm Â· ESC cancel Â· F1 Help Â· F4 View Log`
* Danger actions show red title + double-confirm.
* `[â€¦]` = checkbox Â· `( )` = radio Â· `<â€¦>` = input Â· `â–¶` = default button.

---

# kernel\_build.step\_1 â€” Select Kernel Repository

```
â”Œâ”€ Select Kernel Repository â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Choose a source for the kernel code.                                     â”‚
â”‚                                                                          â”‚
â”‚   â–¸ anbernic/h700-linux (official-ish mirror)                            â”‚
â”‚     community/h700-kernel-tuned                                          â”‚
â”‚     forks/grzegorz/rx28-disp-panel                                       â”‚
â”‚     forks/karol/h700-exp-dma                                             â”‚
â”‚     ----------------------------------------------------------------     â”‚
â”‚     Enter custom URLâ€¦                                                    â”‚
â”‚                                                                          â”‚
â”‚  Details                                                                â”‚
â”‚  Repo: anbernic/h700-linux                                               â”‚
â”‚  Desc: Allwinner H700 A64 family tree + RG35XX H tweaks                  â”‚
â”‚                                                                          â”‚
â”‚                              [ Help ]  [ Cancel ]   â–¶[ Continue ]        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**What it does**

* Lists curated repos from `config/repos.yml` plus a â€œcustom URLâ€ path.
* On â€œcustom URLâ€, opens an input box.

**State updated**

* `WZ[repo_url]`, `WZ[repo_name]`

**Validation**

* If URL empty/invalid â†’ inline error.

---

# kernel\_build.step\_2 â€” Select Branch/Tag

```
â”Œâ”€ Pick Branch or Tag â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Show branches/tags fetched from remote. Use fuzzy search with fzf.       â”‚
â”‚                                                                          â”‚
â”‚   â–¸ branch: main                                                         â”‚
â”‚     branch: rg35xxh-stable                                               â”‚
â”‚     tag: v6.10.12-rg                                                     â”‚
â”‚     tag: v6.10.9                                                         â”‚
â”‚                                                                          â”‚
â”‚  Remote: origin  |  Repo: anbernic/h700-linux                            â”‚
â”‚                                                                          â”‚
â”‚                         [ Back ]  [ Help ]   â–¶[ Continue ]               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**What it does**

* Calls `git ls-remote` (via `lib/git.sh`), renders list.

**State**

* `WZ[ref]` (branch/tag name)

---

# kernel\_build.step\_3 â€” Apply Config Patch?

```
â”Œâ”€ Kernel Config Patch â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Apply a .config fragment to base defconfig, then olddefconfig?           â”‚
â”‚                                                                          â”‚
â”‚   [x] Apply config patch                                                 â”‚
â”‚       Patch file:  ./config_patch                                        â”‚
â”‚       Base defconfig:  defconfig (auto)                                  â”‚
â”‚                                                                          â”‚
â”‚ Notes: uses scripts/kconfig/merge_config.sh, then make olddefconfig.     â”‚
â”‚                                                                          â”‚
â”‚                 [ Back ]  [ Browse Patchâ€¦ ]  [ Help ]  â–¶[ Continue ]     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**What it does**

* Optional merge with `merge_config.sh`, fallback to plain defconfig.

**State**

* `WZ[apply_patch]=1/0`, `WZ[patch_path]`

**Validation**

* If checked but file missing â†’ error banner.

---

# kernel\_build.step\_4 â€” Build Settings

```
â”Œâ”€ Build Settings â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Threads: < 8 >      Target arch: ( ) arm   (â€¢) arm64                     â”‚
â”‚ Output dir: < builds/anbernic-h700/20250919-1122 >                        â”‚
â”‚                                                                          â”‚
â”‚ [ ] Save these as defaults                                                â”‚
â”‚                                                                          â”‚
â”‚ Estimated time: ~6â€“12 min on 8 cores. Progress will be shown.            â”‚
â”‚                                                                          â”‚
â”‚                        [ Back ]  [ Help ]   â–¶[ Start Build ]             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**State**

* `WZ[jobs]`, `WZ[arch]`, `WZ[outdir]`

---

# kernel\_build.step\_5 â€” Build Progress

```
â”Œâ”€ Building Kernel (do not close) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ make -j8 â€¦                                                               â”‚
â”‚                                                                          â”‚
â”‚ [######################â€¦â€¦â€¦â€¦â€¦â€¦â€¦..] 62%                                    â”‚
â”‚  CC drivers/...                                                          â”‚
â”‚  LD vmlinux                                                              â”‚
â”‚                                                                          â”‚
â”‚ Log: logs/20250919-1122-build.log                                        â”‚
â”‚                                                                          â”‚
â”‚                                   [ View Log ]   â–¶[ Run in Background ]  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**What it does**

* Gauge fed by `pv -l` heuristic.
* Background keeps logging; returns to menu with a banner.

---

# kernel\_build.step\_6 â€” Artifacts Summary

```
â”Œâ”€ Build Complete â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Artifacts in: builds/anbernic-h700/20250919-1122                         â”‚
â”‚                                                                          â”‚
â”‚   âœ“ Image.gz                                                             â”‚
â”‚   âœ“ arch/arm64/boot/dts/allwinner/sun50i-h700-anbernic-rg35xx-h.dtb      â”‚
â”‚   âœ“ modules: /lib/modules/6.10.12-rg                                     â”‚
â”‚   âš  boot.img not generated (create via Adjust wizard)                    â”‚
â”‚                                                                          â”‚
â”‚ What next?                                                               â”‚
â”‚   â–¸ Go to Flash Image                                                    â”‚
â”‚     Open Boot.img / RootFS Adjuster                                      â”‚
â”‚     Return to Main Menu                                                  â”‚
â”‚                                                                          â”‚
â”‚                         [ View Log ]   â–¶[ Continue ]                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

# flash.step\_1 â€” Pick Build Artifact

```
â”Œâ”€ Select Image or Kernel to Flash â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   â–¸ builds/.../system.img (3.2 GB)                                       â”‚
â”‚     builds/.../new-boot.img (24 MB)                                      â”‚
â”‚     builds/.../Image.gz (kernel only)                                    â”‚
â”‚     Browseâ€¦                                                               â”‚
â”‚                                                                          â”‚
â”‚ Tip: If flashing a custom kernel, prefer using Boot.img Adjuster next.   â”‚
â”‚                                                                          â”‚
â”‚                            [ Back ]  [ Help ]   â–¶[ Continue ]            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**State**

* `WZ[artifact_path]`

---

# flash.step\_2 â€” Select SD Card

```
â”Œâ”€ Choose Target Device â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Detected block devices:                                                  â”‚
â”‚   â–¸ /dev/sdb  64 GB  KINGSTON  (Suggested)                               â”‚
â”‚     /dev/sdc  256 GB SAMSUNG                                            â”‚
â”‚                                                                          â”‚
â”‚ Partitions (/dev/sdb):                                                   â”‚
â”‚   p1 â€¦                                                                    â”‚
â”‚   p4  64 MB  (boot)                                                      â”‚
â”‚   p5  12 GB  (rootfs)                                                    â”‚
â”‚                                                                          â”‚
â”‚ ğŸ”´ WARNING: Writing to a disk will erase data. Make a backup first.      â”‚
â”‚                                                                          â”‚
â”‚                    [ Back ]  [ Help ]   â–¶[ I Understand, Continue ]      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Guardrail**

* If target is system root â†’ hard block with explanation.

---

# flash.step\_3 â€” Backup First?

```
â”Œâ”€ Backup Before Flash â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Recommended. Choose scope:                                               â”‚
â”‚   (â€¢) Full disk â†’ backups/disk-KINGSTON-64GB-20250919.img.zst            â”‚
â”‚   ( ) Boot partition only â†’ backups/boot-20250919.img                    â”‚
â”‚   ( ) Skip backup                                                        â”‚
â”‚                                                                          â”‚
â”‚ Compression: (â€¢) zstd  ( ) gzip  ( ) none                                â”‚
â”‚                                                                          â”‚
â”‚                     [ Back ]  [ Help ]   â–¶[ Start Backup ]               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

# flash.step\_4 â€” Flash Progress

```
â”Œâ”€ Flashing /dev/sdb (do not remove) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ pv image.img | dd of=/dev/sdb bs=4M conv=fsync status=progress           â”‚
â”‚                                                                          â”‚
â”‚ [#########################â€¦â€¦â€¦â€¦â€¦â€¦] 71%  (93 MB/s, 1m22s remaining)        â”‚
â”‚                                                                          â”‚
â”‚ Log: logs/20250919-1144-flash.log                                        â”‚
â”‚                                                          â–¶[ View Log ]   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

# flash.step\_5 â€” Verify & Done

```
â”Œâ”€ Flash Complete â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Optional verify?                                                         â”‚
â”‚   [ ] Compare hashes (slow)                                              â”‚
â”‚                                                                          â”‚
â”‚ Next steps:                                                              â”‚
â”‚   â–¸ Run Boot.img / RootFS Adjuster                                       â”‚
â”‚     Return to Main Menu                                                  â”‚
â”‚                                                                          â”‚
â”‚                         [ View Log ]   â–¶[ Continue ]                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

# bootimg\_adjust.step\_1 â€” Choose Base (Stock) Boot Image

```
â”Œâ”€ Boot.img / RootFS Adjuster â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ How would you get the base (stock) boot image?                           â”‚
â”‚   â–¸ Extract from device partition now (/dev/sdb4 ~64 MB)                 â”‚
â”‚     Browse fileâ€¦                                                         â”‚
â”‚                                                                          â”‚
â”‚ Note: Stock header sets pagesize/base/cmdlineâ€”copying these avoids loops.â”‚
â”‚                                                                          â”‚
â”‚                            [ Back ]  [ Help ]   â–¶[ Continue ]            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**If extract chosen** â†’ backs up `/dev/sdb4` to `backups/boot-<ts>.img` first.

---

# bootimg\_adjust.step\_2 â€” Extraction Summary

```
â”Œâ”€ Extracted Stock Boot Image â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Work dir: work/bootimg-20250919-1157/                                    â”‚
â”‚ Header: page_size=2048  base=0x40000000  cmdline=â€¦                       â”‚
â”‚ Files:                                                                   â”‚
â”‚   kernel            18.2 MB                                              â”‚
â”‚   ramdisk.cpio.gz    6.8 MB                                              â”‚
â”‚   dtb               present                                              â”‚
â”‚   bootimg.cfg       present                                              â”‚
â”‚                                                                          â”‚
â”‚                    [ Back ]   â–¶[ Select New Kernel ]   [ View Log ]      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

# bootimg\_adjust.step\_3 â€” Select New Kernel

```
â”Œâ”€ Select New Kernel Image â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   â–¸ builds/.../Image.gz (Linux 6.10.12-rg)                               â”‚
â”‚     builds/.../zImage                                                    â”‚
â”‚                                                                          â”‚
â”‚ Detected version: 6.10.12-rg   (from strings)                            â”‚
â”‚                                                                          â”‚
â”‚                        [ Back ]  [ Help ]   â–¶[ Continue ]                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**State**

* `WZ[new_kernel]`, `WZ[new_kernel_ver]`

---

# bootimg\_adjust.step\_4 â€” DTB Mode

```
â”Œâ”€ Choose DTB Mode â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Select how the DTB is provided to the boot image.                        â”‚
â”‚   (â€¢) with-dt   â†’ mkbootimg --dt dtb.img                                 â”‚
â”‚   ( ) catdt     â†’ cat Image + dtb.img â†’ Image_dtb                        â”‚
â”‚                                                                          â”‚
â”‚ Device profile: RG35XX-H (Allwinner H700)                                â”‚
â”‚ Tip: Try with-dt first; catdt is a fallback for picky bootloaders.       â”‚
â”‚                                                                          â”‚
â”‚                        [ Back ]  [ Help ]   â–¶[ Continue ]                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

# bootimg\_adjust.step\_5 â€” Select DTB Variant(s)

```
â”Œâ”€ Select DTB Variant â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   â–£ sun50i-h700-anbernic-rg35xx-h.dtb                                    â”‚
â”‚   â˜ sun50i-h700-anbernic-rg35xx-h-rev6-panel.dtb                         â”‚
â”‚   â˜ rg40xx-h.dtb (compat)                                                â”‚
â”‚                                                                          â”‚
â”‚ If multiple selected â†’ build dtb.img (mkdtimg/cat per profile).          â”‚
â”‚                                                                          â”‚
â”‚                        [ Back ]  [ Help ]   â–¶[ Build dtb.img ]           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Validation**

* At least one DTB must be chosen.

---

# bootimg\_adjust.step\_6 â€” Cmdline Editor

```
â”Œâ”€ Kernel Cmdline (advanced) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ From stock:                                                              â”‚
â”‚   console=ttyS0,115200 console=tty0 root=/dev/mmcblk0p5 rw â€¦             â”‚
â”‚                                                                          â”‚
â”‚ Quick toggles:                                                           â”‚
â”‚   [x] console=tty0          [x] ignore_loglevel     [ ] earlycon         â”‚
â”‚                                                                          â”‚
â”‚ Edit:                                                                    â”‚
â”‚ < console=ttyS0,115200 console=tty0 root=/dev/mmcblk0p5 rw â€¦           > â”‚
â”‚                                                                          â”‚
â”‚                        [ Back ]  [ Help ]   â–¶[ Save & Continue ]         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

# bootimg\_adjust.step\_7 â€” Repack Boot Image

```
â”Œâ”€ Repack boot.img â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ mkbootimg with:                                                          â”‚
â”‚   --kernel:   builds/.../Image.gz                                        â”‚
â”‚   --ramdisk:  ramdisk.cpio.gz                                            â”‚
â”‚   --dt:       dtb.img (mode: with-dt)                                    â”‚
â”‚   --pagesize: 2048   --base: 0x40000000                                  â”‚
â”‚   --cmdline:  (edited)                                                   â”‚
â”‚                                                                          â”‚
â”‚ [ Start ]                                                                â”‚
â”‚                                                                          â”‚
â”‚ [###############â€¦â€¦â€¦â€¦â€¦â€¦â€¦] 54%                                             â”‚
â”‚                                                                          â”‚
â”‚ Output: builds/.../new-boot.img (24 MB)                                   â”‚
â”‚                                                                          â”‚
â”‚                           â–¶[ Continue ]  [ View Log ]                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Guardrails**

* If output > boot partition size â†’ **abort with fix tips**.

---

# bootimg\_adjust.step\_8 â€” Modules Sync

```
â”Œâ”€ Sync Kernel Modules to RootFS â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Detected kernel: 6.10.12-rg                                              â”‚
â”‚ RootFS partition: /dev/sdb5 (mount: /mnt/rootfs)                         â”‚
â”‚                                                                          â”‚
â”‚   â–¸ Copy ./lib/modules/6.10.12-rg â†’ /mnt/rootfs/lib/modules/â€¦            â”‚
â”‚   â–¸ Run depmod -a -b /mnt/rootfs 6.10.12-rg                              â”‚
â”‚                                                                          â”‚
â”‚ [x] Do this now (recommended)                                            â”‚
â”‚                                                                          â”‚
â”‚                        [ Skip ]                      â–¶[ Execute ]         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

# bootimg\_adjust.step\_9 â€” Flash Boot Partition

```
â”Œâ”€ Flash new-boot.img to /dev/sdb4 â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ First, a safety backup will be created: backups/boot-20250919-pre.img    â”‚
â”‚                                                                          â”‚
â”‚ [#########â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦] 28%  (backup)                                   â”‚
â”‚ [#############################â€¦â€¦] 82%  (flash)                            â”‚
â”‚                                                                          â”‚
â”‚ Log: logs/20250919-1210-adjust.log                                       â”‚
â”‚                                                          â–¶[ View Log ]   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Double confirm**

* Dialog with the exact device path, model, size.

---

# bootimg\_adjust.step\_10 â€” Optional QEMU Smoke Test

```
â”Œâ”€ QEMU Boot Test (optional) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Running headless bootâ€¦ capturing first 200 lines of kernel log.          â”‚
â”‚                                                                          â”‚
â”‚ [ OK ] Decompressing Linuxâ€¦                                              â”‚
â”‚ [ OK ] Mounting rootâ€¦                                                    â”‚
â”‚ â€¦                                                                         â”‚
â”‚                                                                          â”‚
â”‚ Save log to: logs/20250919-qemu.log                                      â”‚
â”‚                                                                          â”‚
â”‚                         [ Skip ]  â–¶[ Save & Continue ]                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

# bootimg\_adjust.step\_11 â€” Done

```
â”Œâ”€ Adjuster Complete â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ New boot.img is flashed and modules synced.                              â”‚
â”‚                                                                          â”‚
â”‚ Next steps:                                                              â”‚
â”‚   â–¸ Power off device, reinsert SD, and boot.                             â”‚
â”‚   â–¸ If black screen: rerun Adjuster with alternate DTB or catdt mode.    â”‚
â”‚                                                                          â”‚
â”‚                         [ View Log ]   â–¶[ Return to Menu ]               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

# backup\_restore.step\_1 â€” Choose Action

```
â”Œâ”€ Backup / Restore â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   â–¸ Backup full disk                                                     â”‚
â”‚     Backup single partition                                              â”‚
â”‚     Restore full disk                                                    â”‚
â”‚     Restore single partition                                             â”‚
â”‚                                                                          â”‚
â”‚                         [ Back ]   â–¶[ Continue ]                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

# backup\_restore.step\_2 â€” Pick Source / Target

```
â”Œâ”€ Select Source & Destination â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Source:                                                                  â”‚
â”‚   â–¸ /dev/sdb (KINGSTON 64 GB)                                            â”‚
â”‚                                                                          â”‚
â”‚ Destination file: < backups/disk-KINGSTON-64GB-20250919.img.zst >        â”‚
â”‚ Compression: (â€¢) zstd  ( ) gzip  ( ) none                                â”‚
â”‚                                                                          â”‚
â”‚                         [ Back ]  [ Help ]   â–¶[ Start ]                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

*(Restore swaps roles: file â†’ device with double confirm)*

---

# backup\_restore.step\_3 â€” Progress & Verify

```
â”Œâ”€ Running backup â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ [################â€¦â€¦â€¦â€¦â€¦â€¦â€¦] 63%  (78 MB/s)                                â”‚
â”‚                                                                          â”‚
â”‚ [ ] Verify after completion (hash compare)                               â”‚
â”‚                                                                          â”‚
â”‚ Log: logs/20250919-1230-backup.log                                       â”‚
â”‚                                                          â–¶[ View Log ]   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

# backup\_restore.step\_4 â€” Done

```
â”Œâ”€ Operation Complete â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Backup saved to: backups/disk-KINGSTON-64GB-20250919.img.zst             â”‚
â”‚                                                                          â”‚
â”‚ Next:                                                                    â”‚
â”‚   â–¸ Return to Main Menu                                                  â”‚
â”‚   â–¸ Open folder                                                          â”‚
â”‚                                                                          â”‚
â”‚                         [ Open Folder ]   â–¶[ Finish ]                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Flow glue (what triggers what)

* **From Build â†’ Flash**: Offer CTA as soon as artifacts exist.
* **From Flash â†’ Adjust**: After flashing a system image or raw kernel, propose Adjuster to ensure boot.img+modules coherence (prevents loops).
* **From Adjust â†’ Backup/Restore**: Always offer quick restore if size/verify fails.
* **Logs**: every wizard writes a timestamped log and exposes â€œView Logâ€.